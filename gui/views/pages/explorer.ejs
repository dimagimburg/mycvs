<!DOCTYPE html>
<html>
<head>
	<% include ../partials/head %>
	<link rel="stylesheet" href="public/css/explorer.css">
	<script src="/public/js/explorer/events.js"></script>
</head>
<body>
	<div class="error alert alert-danger" role="alert"></div>

	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        <h4 class="modal-title" id="myModalLabel">Please fill the next form to config your repository	</h4>
	      </div>
	      <div class="modal-body">
      		<div>
      			<form id="create-repository-form">
      				<h3>Admin details</h3>
  					<div class="form-group">
				    	<label for="username">Email address</label>
				    	<input type="text" class="form-control" id="username" placeholder="Username" required>
				  	</div>
				  	<div class="form-group">
				    	<label for="password">Password</label>
				    	<input type="password" class="form-control" id="password" placeholder="Password" required>
				  	</div>
				  	<h3>Repository details</h3>
				  	<div class="form-group">
				    	<label for="reponame">Repository Name</label>
				    	<input type="text" class="form-control" id="reponame" placeholder="Repository name" required>
				  	</div>
				  	<h3>Server Details</h3>
				  	<div class="form-group">
				    	<label for="serveraddres">Server address</label>
				    	<input type="text" class="form-control" id="serveraddres" placeholder="Server address" required>
				  	</div>
				  	<div class="form-group">
				    	<label for="serverport">Server port</label>
				    	<input type="text" class="form-control" id="serverport" placeholder="Server port" required>
				  	</div>
      			</form>
      		</div>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default close-create-repository-button" data-dismiss="modal">Close</button>
	        <button type="submit" class="btn btn-primary create-repository-button" form="create-repository-form">Create Repository</button>
	      </div>
	    </div>
	  </div>
	</div>

	<div class="side-bar">
		<div class="mycvs-logo">
			MYCVS V1.0.0
		</div>
		<div class="nav-links">
			<ul>
				<li>
					<span class="glyphicon glyphicon-list" aria-hidden="true"></span>Documentation
				</li>
			</ul>
		</div>
	</div><div class="body">
		<div class="top-nav">
			<% if(isRepository){ %>
				<button type="button" class="btn btn-success choose-directory">
					<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
					Select Repository
				</button>
			<% } else { %>
			  	<button type="button" class="btn btn-primary create-repository">
					<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
					New Repository
				</button>
		  	<% } %>
			
		</div>
		<div class="file-explorer">
			<div class="path">
				<span class="glyphicon glyphicon-folder-open" aria-hidden="true" style="color:#A9A7B5;"></span>
				<% if(!upperPath.currentPath.length) { %>
				<span class="separator">/</span>
				<% } %>
				<% for(var i = 0; i < upperPath.currentPath.length; i++) { %>
	        		<span class="separator">/</span>
	        		<span class="directory" data-path="<%= upperPath.subPaths[i] %>"><%= upperPath.currentPath[i] %></span>
	    		<% } %>
			</div>
			<div class="directory-files">
				<table class="table table-striped">
					<tr>
						<th>File Name</th>
						<th>Last Modified</th>
					</tr>
					<% if(upperPath.currentPath.length > 1){ %>
					<tr>
						<td>
							<span class="glyphicon glyphicon-folder-open folder-icon" aria-hidden="true"></span>
							<span class="directory" data-path="<% var dotdot = upperPath.currentPath; dotdot.pop(); %><%= '/' + dotdot.join('/') %>">
								..
							</span>
						</td>
						<td>
						</td>
					</tr>
				<% } %>
				<% for(var i = 0; i < bottomList.directories.length; i++){ %>
					<tr <% if(bottomList.directories[i].directoryName[0] == '.'){ %>style="display:none;"<% } %>>
						<td>
							<span class="glyphicon glyphicon-folder-open folder-icon" aria-hidden="true"></span>
							<span class="directory <% if(bottomList.directories[i].isRepository){ %>is-repository<% } %>" data-path="<%= currentPathString + '/' + bottomList.directories[i].directoryName%>">
								<%= bottomList.directories[i].directoryName %>
							</span>
						</td>
						<td>
							[<%= bottomList.directories[i].lastModified.toLocaleDateString(); %>] - 
							[<%= ("0" + bottomList.directories[i].lastModified.getHours()).slice(-2)  %> :
							<%= ("0" + bottomList.directories[i].lastModified.getMinutes()).slice(-2)  %> :
							<%= ("0" + bottomList.directories[i].lastModified.getSeconds()).slice(-2)  %>]
						</td>
					</tr>
				<% } %>
				<% for(var i = 0; i < bottomList.files.length; i++){ %>
					<tr <% if(bottomList.files[i].fileName[0] == '.'){ %>style="display: none;"<% } %>>
						<td>
							<span class="glyphicon glyphicon-file file-icon" aria-hidden="true"></span>
							<span class="file" data-path="<%= currentPathString + '/' + bottomList.files[i].fileName %>">
								<%= bottomList.files[i].fileName %>
							</span>
						</td>
						<td>
							[<%= bottomList.files[i].lastModified.toLocaleDateString(); %>] - 
							[<%= ("0" + bottomList.files[i].lastModified.getHours()).slice(-2)  %> :
							<%= ("0" + bottomList.files[i].lastModified.getMinutes()).slice(-2)  %> :
							<%= ("0" + bottomList.files[i].lastModified.getSeconds()).slice(-2)  %>]
						</td>
					</tr>
				<% } %>
				</table>
			</div>
		</div>
	</div>
</body>
</html>
